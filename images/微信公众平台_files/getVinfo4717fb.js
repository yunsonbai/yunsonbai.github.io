define("pages/modules/media/common/media.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.weui-desktop-media__opr {  position: absolute;  left: 100%;  top: 0;  bottom: 0;  opacity: 0;  visibility: hidden;  transition: opacity .3s;  white-space: nowrap;}.weui-desktop-media__opr:after {  content: \" \";  display: inline-block;  vertical-align: middle;  width: 0;  height: 100%;  overflow: hidden;}.weui-desktop-media__opr .weui-desktop-link:first-child {  margin-left: 1em;}.weui-desktop-media:hover .weui-desktop-media__opr {  opacity: 1;  visibility: visible;}.weui-desktop-media-card__opr {  position: absolute;  right: 15px;  bottom: 24px;  opacity: 0;  visibility: hidden;  transition: opacity .3s;}.weui-desktop-media-card:hover .weui-desktop-media-card__opr {  opacity: 1;  visibility: visible;}";});define("pages/modules/media/audio/audio.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.weui-desktop-audio {  width: 320px;  background-color: #FCFCFC;  padding: 14px 15px 6px;  font-size: 16px;  border: 1px solid #E0E0E0;  border-radius: 4px;  -moz-border-radius: 4px;  -webkit-border-radius: 4px;  -webkit-box_sizing: border-box;  box_sizing: border-box;  display: inline-block;  vertical-align: middle;  position: relative;}.weui-desktop-audio .weui-desktop-audio-player {  padding-right: 15px;}.weui-desktop-audio .weui-desktop-audio-player__switch {  margin-top: -8px;}.weui-desktop-audio__title {  display: block;  font-weight: 400;  overflow: hidden;  text-overflow: ellipsis;  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-line-clamp: 1;  height: 1.6em;  margin-bottom: 1em;}.weui-desktop-audio__tips {  overflow: hidden;  text-overflow: ellipsis;  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-line-clamp: 1;  height: 1.6em;  padding-bottom: .5em;  font-size: 12px;  color: #9A9A9A;}.weui-desktop-audio__progress {  height: 2px;  background-color: #EBEBEB;}.weui-desktop-audio__progress_inner {  background-color: #09BB07;  height: 100%;}.weui-desktop-audio__desc {  color: #9A9A9A;  overflow: hidden;  padding-top: .25em;  font-size: 12px;}.weui-desktop-audio__desc em {  font-style: normal;}.weui-desktop-audio__length_current {  float: left;}.weui-desktop-audio__length_total {  float: right;}";});define("pages/modules/media/audio/audio.tpl.js",[],function(e,t,i){return'<span><svg xmlns="http://www.w3.org/2000/svg" style="width:0;height:0;visibility:hidden;position:absolute;z-index:-1"><symbol id="common-edit" viewBox="0 0 16 17"><path d="M8 1H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V8h-2v7H2V3h6V1z"></path><path d="M15.185 2.714l.448-.448c.3-.3.31-.81 0-1.118l-.296-.296a.787.787 0 0 0-1.118 0l-.448.448 1.414 1.414zm-.707.707L8.414 9.485 7 8.071l6.064-6.064 1.414 1.414zm-8.15 6.21L7 8.071l1.414 1.414-1.56.673c-.515.222-.747-.016-.526-.527z"></path></symbol><symbol id="common-del" viewBox="0 0 16 18"><path d="M1 5c-.556 0-1-.448-1-1 0-.556.448-1 1-1h14c.555 0 1 .448 1 1 0 .556-.448 1-1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V5zm12 0H3v11h10V5zM5.99 0h4.02A1 1 0 0 1 11 1v1H5V1c0-.556.444-1 .99-1zM10 7c.556 0 1 .446 1 .997v6.006c0 .544-.448.997-1 .997-.556 0-1-.446-1-.997V7.997C9 7.453 9.448 7 10 7zM6 7c.556 0 1 .446 1 .997v6.006c0 .544-.448.997-1 .997-.556 0-1-.446-1-.997V7.997C5 7.453 5.448 7 6 7z"></path></symbol></svg><div class="weui-desktop-audio">    <mp-audio-player :disabled="disabled" :src="src" extclass="weui-desktop-vm weui-desktop-vm_default" @timeupdate="timeUpdate"></mp-audio-player>  <div class="weui-desktop-audio__info weui-desktop-vm weui-desktop-vm_primary">    <strong class="weui-desktop-audio__title">{{title}}</strong>    <div class="weui-desktop-audio__progress">      <div class="weui-desktop-audio__progress_inner" :style="\'width:\' + progressPercentage(currentTime, duration) + \'%\'"></div>    </div>    <div class="weui-desktop-audio__desc">      <em class="weui-desktop-audio__length_current">{{convertTimeString(currentTime)}}</em>      <em class="weui-desktop-audio__length_total">{{convertTimeString(duration)}}</em>    </div>  </div>  <div v-if="operator.show" class="weui-desktop-media__opr">    <mp-tooltip class="weui-desktop-link"  v-if="operator.edit" content="编辑" position="down-center" :delay="300">      <button @click="onOperate(\'edit\')" slot="target" class="weui-desktop-icon-btn weui-desktop-opr-btn weui-desktop-opr-btn_primary">        <svg width="16" height="17" xmlns="http://www.w3.org/2000/svg"><use xlink:href="#common-edit"/></svg>      </button>    </mp-tooltip>    <mp-tooltip class="weui-desktop-link" v-if="operator.delete" content="删除" position="down-center" :delay="300">      <button @click="onOperate(\'delete\')" slot="target" class="weui-desktop-icon-btn weui-desktop-opr-btn weui-desktop-opr-btn_primary">        <svg width="16" height="18" xmlns="http://www.w3.org/2000/svg"><use xlink:href="#common-del"/></svg>      </button>    </mp-tooltip>  </div></div></span>'})
define("pages/modules/media/audio/audio_player.js",["pages/modules/media/audio/audio_player.css.js","pages/modules/media/audio/audio_player.tpl.js","pages/modules/utils/audio_center.js"],function(e,t,a){"use strict"
e("pages/modules/media/audio/audio_player.css.js")
var i=e("pages/modules/media/audio/audio_player.tpl.js"),s=e("pages/modules/utils/audio_center.js")
Vue.component("mp-audio-player",{template:i,props:{extclass:{type:String,dafault:""},iconclass:{type:String,default:"weui-desktop-audio-player__switch"},src:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{status:"stopped"}},mounted:function(){var t=this
this._audioItem=s.createAudioItem(),this._audioItem.bindStatusChange(function(e){"error"===e&&t.$tipsErr("音频播放失败，请检查网络状态，或尝试使用其他浏览器播放"),t.status=e}),this._audioItem.bindTimeUpdate(function(e){t.$emit("timeupdate",e)})},destroyed:function(){"playing"===this.status&&this._audioItem.stop()},methods:{click:function(){if(this.disabled)return!1
var e=this._audioItem
return"playing"===e.getStatus()?e.stop():(e.setSource(this.src),e.playWithLock()),!1}}})})
define("pages/modules/media/audio/audio_player.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.weui-desktop-audio-player__switch {  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABUCAMAAAArteDzAAAAaVBMVEUAAAAarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRkarRlIa6J1AAAAInRSTlMA9wYa38QR7ZJnMK1IIqBsO3fXDbSGQudZz5fKpV0rfbpRlHIjYQAAA35JREFUWMPFWduyqjAMDS0tgtwEFBGv/P9Hntmh3cWDTYsMs/Oio3SRy0qapuCU7PXIRdUGQxCFncgfrwzWCb/l4TCTML/xbxFlIQariEJ+AZnkwUBKkCdLIZvBQ5olsPw61Uhc4vTOa4Ca39P4IqYWXH2dyw5mWXUs2ez/8liZVx6YD2bW6wXRzmpesov0U70HxW5azTBmpD1xqJW9uUzfaS0Lp1ms0Nru6Nfv9WPSi8lahT2BKoWyvARPKZUPhLRiduq9ckHaKds6y5pa6XmARXJQutaEP4MzLJTzyJfmk193I2YKiyUdUXcf+OnCdKPO+JqNvxO2kx4YNcr+c2jvjpE7Wv27W4uRS/C1jFEu3mpdhJyX34PWISY3ByNj/SxhhZRjfZ0UMkUJt3Bxx08rJU2xbFB16YEZDiG3JSy6sHlXNPbCHIbOVpHiN1VzjBLzKOCkmxjGKld6B4oNbjkiqi3rkJeBNN8jBj7SUEaxyGgnjE1OkS0mHkUAgd5X/qWF80mWR7PaOY0410GrnHHXVHpSqlZII521RzeXqtpkTkgEEitIiwF1YeLDJgQnIldbgAx5wMBj5z4br+aWB5GdGbxUxGjUp6ESLmxhJsaMFzx+Pi5+VIpN6bTUlcvPfw/InXlvjO5MjsdE/ucg6DjxRlEJY4Wb0J1IlnR0ZoXGEHF/6l1I68d+vj3ho9xH0mO+cjumNiMxvg/tTOWYcIAkqCl+XjRbtH7CHv4aCQrIQIui3TCxNPyN1BMXfhQFFxCgJ/yzmYAaTpGgEZpPoOq60GJctfkRaX5IBApRVTNTm/TvnYHqCEoh6kMzUCuNxnUUpVzkB/2+/Pc5iTpT5PdNUx78FrMT6kymqbugmEpxNZU4JXaph7v0GbOGxJQ3SZU+ryINSWT8iAt6skg7txPD1wCJN/rrQG0nZuNzo54nHQOnNj6zRTtRj5Pe5klu0d7NBGTThvFENhNE20NQS5BtD9GgUdQqyQZtaSuZ4bIr1fUGcmHTCz1SRpJNL9GeE3xNHe35/CDhRj04DhLzI48b9eI48mxxONvyGLn+wGtsLTY5mm87RFg/7jhNxh3bD2aANWtHSFsOu7Yfy60fIG4/6lw/lN14fOwedJdWXxKD7m1H8u7LAwZMZsn88mCDa46/v5DZ6OoIhcf7dg7Y7mPalb7XcVEwDEFU+V3H/QOplcP+ctPpgwAAAABJRU5ErkJggg==) no-repeat 0 0;  width: 42px;  height: 42px;  vertical-align: middle;  display: inline-block;  background-size: 42px auto;  cursor: pointer;}.weui-desktop-audio_playing .weui-desktop-audio-player__switch {  background-image: url(data:image/gif;base64,R0lGODlhVABUAPfJAButGiKwIe747m7Kbe/47/r8+vj7+J3bnB+vHqDcny20LByuG+j16Pz9/HvPeiOwIk/ATuT05FLBUTa3Np7bnTm4OCqzKdXv1ff79ySwI8Lowi+1Lj66Pb3mvdvx23nPeaTepMjqyLXktVzEW63hrTW2NEu+So7WjdLu0j66PrzmvKrgqn7QfeL04p/cnkm+SCiyJ7/nvmTHYyGwIPn8+fX69d7y3vb69iWxJE2/TPL58iuzKqzgrHjOeEW8RPT69PH58ZXYlNDtz4bThSyzK+337eb15mLGYdbv1mnJaW/Lb8bqxja3NeX15V3FXPD48GHGYfP689fw11HAUHzQe3fOd0q+STi4N8rrytPu01/FXz25PGzKa17FXez37CCvH6ngqaDcoOn26ODz3x6vHZLXkiaxJef150y/S+Hz4NDt0E/AT77nvrTjtJfZlnrPeje3N0K7QWvKaoXThLvmu8fqxmXHZIPSg5bZlavgq8/tz9zx3JzbnI/WjtHu0Ue9RkS8Q93y3ZTYk6LdovH58FfDV2DGYInUiX3QfIfThmfIZtnw2Dq4OZDXkLrlulDAUIzVi43VjG/LbsPpw/n7+XTNc1TBUx6uHcDnv3DLcDG1MN/y31/FXsjqx2jJaFPBUi60LS60LljDWHXNdGbIZTS2M6/hrnfOdke9R9Tv1FbCVWPHYkC6P1rEWbDir0a8RVXCVMnryYvVi4jUiMHowVnDWMvry+v36zO2Mqjfpx2uHGfIZyeyJsDowLHisZHXkZPYk7nluXbNddnw2fv8+4fUhzC1LxqtGf39/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4NzEyYzBkMi03NGJlLTQ5MTEtYmQyMi1lNmI4ZTlhZmQ5ZGIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkUzMTAyRkEyMjg0MTFFN0JDNzBCMEY5NjNCMDhDQjQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkUzMTAyRjkyMjg0MTFFN0JDNzBCMEY5NjNCMDhDQjQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4NzEyYzBkMi03NGJlLTQ5MTEtYmQyMi1lNmI4ZTlhZmQ5ZGIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6ODcxMmMwZDItNzRiZS00OTExLWJkMjItZTZiOGU5YWZkOWRiIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJ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);}";});define("pages/modules/media/audio/audio_player.tpl.js",[],function(e,i,s){return'<div :class="\'weui-desktop-audio-player weui-desktop-audio_\' + status + \' \' + extclass">  <em :class="iconclass" @click="click" title="点击播放"></em></div>'})
define("pages/modules/utils/audio_center.js",[],function(t,e,i){"use strict"
function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(){n(this,t),this.onstatuschange=null}return s(t,[{key:"setSource",value:function(t){this._audio=null,this._status="stopped",this._src=t}},{key:"playWithLock",value:function(){u.fetchLock(this),this._play()}},{key:"playWithoutLock",value:function(){this._play()}},{key:"stop",value:function(){u.releaseLock(this),this._stop()}},{key:"getStatus",value:function(){return this._status}},{key:"releaseLock",value:function(){this._stop()}},{key:"bindStatusChange",value:function(t){this.onstatuschange=t}},{key:"_triggerStatusChange",value:function(){this.onstatuschange&&this.onstatuschange(this._status)}},{key:"bindTimeUpdate",value:function(t){this.ontimeupdate=t}},{key:"_triggerTimeUpdate",value:function(){this.ontimeupdate&&this.ontimeupdate(1e3*this._audio.currentTime,1e3*this._audio.duration)}},{key:"_play",value:function(){var t=this
if(!this._audio){var e=document.createElement("audio")
e.addEventListener("error",function(){t._audio=null,t._status="error",t._triggerStatusChange()},!1),e.addEventListener("ended",function(){t._status="stopped",t._triggerStatusChange()},!1),e.addEventListener("timeupdate",function(){t._triggerTimeUpdate()},!1),e.addEventListener("playing",function(){"loading"===t._status&&(t._status="playing",t._triggerStatusChange())},!1),e.addEventListener("waiting",function(){"playing"===t._status&&(t._status="loading",t._triggerStatusChange())},!1),e.src=this._src,this._audio=e}this._status="loading",this._triggerStatusChange(),this._audio.play()}},{key:"_stop",value:function(){this._audio&&(this._status="stopped",this._triggerStatusChange(),this._audio.pause(),this._audio.currentTime=0)}}]),t}(),u=function(){function t(){n(this,t)}return s(t,null,[{key:"createAudioItem",value:function(){return new a}},{key:"fetchLock",value:function(t){this._lock&&this.releaseLock(this._lock),this._lock=t}},{key:"releaseLock",value:function(t){this._lock===t&&(this._lock.releaseLock(),this._lock=null)}},{key:"stop",value:function(){this._lock&&(this._lock.releaseLock(),this._lock=null)}}]),t}()
i.exports=u})
define("pages/editor/videoDialog4Web1.js",["pages/modules/media_dialog/video_dialog/video_dialog.js"],function(e,o,a){"use strict"
function i(){return{canusetxvideo:!0,canuselink:!0,tabselected:"library",scene:"default",showsharedialog:!1,isShow:!1,allowChooseLength:1,videoList:[]}}e("pages/modules/media_dialog/video_dialog/video_dialog.js"),a.exports={getParmas:i,bindEvent:function(s){s.eventBus.$on("showVideoDialog",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o={canusetxvideo:!0,canuselink:!0,tabselected:"library",scene:"default",showsharedialog:!1,isShow:!1,allowChooseLength:1,videoList:[]}
for(var a in e)void 0!==o[a]&&(o[a]=e[a])
for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(s.params[i]=o[i])
s.params.isShow=!0}),s.eventBus.$on("showRelatedVideoDialog",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o={canusetxvideo:!0,canuselink:!0,tabselected:"library",scene:"default",showsharedialog:!1,isShow:!1,allowChooseLength:1,videoList:[]}
for(var a in e)void 0!==o[a]&&(o[a]=e[a])
for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(s.params[i]=o[i])
s.params.isShow=!0})},close:function(e){e.data&&(e.data.isMyMpVideo=!("library"!==e.tab||!e.data.is_mp_video)),e.scene&&"morevideo"===e.scene?e.eventBus.$emit("showRelatedVideoDialog_callback",e.data):e.eventBus.$emit("showVideoDialog_callback",e.data,e.tab)}}})
define("pages/modules/media_dialog/video_dialog/video_dialog.js",["vue-weui/src/pagination/pagination.js","vue-weui/src/tab/tab.js","vue-weui/src/dialog/dialog.js","pages/modules/media_dialog/video_dialog/video_dialog.css.js","vue-weui/src/checkbox/checkbox.js","vue-weui/src/input/input.js","vue-weui/src/utils/loadscript.js","pages/modules/media_dialog/video_dialog/video_dialog.tpl.js","pages/modules/utils/cgi.js","vue-weui/src/utils/time.js","pages/media/modules/video_status/video_status.js","pages/media/modules/common/getVinfo.js","vue-weui/src/utils/string.js"],function(t,e,i){"use strict"
var h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]
for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}
t("vue-weui/src/pagination/pagination.js"),t("vue-weui/src/tab/tab.js"),t("vue-weui/src/dialog/dialog.js"),t("pages/modules/media_dialog/video_dialog/video_dialog.css.js"),t("vue-weui/src/checkbox/checkbox.js"),t("vue-weui/src/input/input.js")
var u=t("vue-weui/src/utils/loadscript.js").load,n=t("pages/modules/media_dialog/video_dialog/video_dialog.tpl.js"),r=t("pages/modules/utils/cgi.js"),o=t("vue-weui/src/utils/time.js"),d=t("pages/media/modules/video_status/video_status.js"),c=t("pages/media/modules/common/getVinfo.js"),l=t("vue-weui/src/utils/string.js"),f=window.BJ_REPORT
function s(t,e){if(!t)return 0;(t=t.cloneNode(!0)).style.visibility="hidden",document.body.appendChild(t)
var i=0,n=t.offsetHeight
e?i+=parseInt(window.getComputedStyle(t).marginTop,10)+parseInt(window.getComputedStyle(t).marginBottom,10)+n:i+=n
return document.body.removeChild(t),t.style.visibility="visible",i}function a(t,e,i){var n=1<arguments.length&&void 0!==e?e:"default",o=2<arguments.length&&void 0!==i?i:1,s=!1
switch(n){case"ueditor":case"masssend":s=!0
break
case"morevideo":s=!1
break
case"default":default:s=!0}return{loading:!1,list:[],totalCount:0,pageLen:10,selectedData:"morevideo"===n?t:[],showUpload:s,allowChooseLength:o,currentPage:1,showSelected:!1}}function g(t){return{loading:!1,list:[],totalCount:0,pageLen:10,selectedData:[],allowChooseLength:t,currentPage:1,inputLink:"",showLinkInfo:!1,showSelected:!1,linkInputStatus:"normal"}}Vue.component("mp-video-dialog",{template:n,props:{videoList:{type:Array,default:function(){return[]}},value:{type:Boolean,default:!1},canusetxvideo:{type:Boolean,default:!0},canuselink:{type:Boolean,default:!1},tabselected:{type:String,default:"library",validator:function(t){return-1<["library","link"].indexOf(t)}},scene:{type:String,default:"ueditor",validator:function(t){return-1<["ueditor","masssend","morevideo","default"].indexOf(t)}},showsharedialog:{type:Boolean,default:!1},allowChooseLength:{type:Number,default:1}},data:function(){var t,e,i,n=this.videoList||[],o=function(t){return"morevideo"===(0<arguments.length&&void 0!==t?t:"default")?"从全量群发的视频消息中选择":"选择视频"}(this.scene)
return{tabs:(t=this.canusetxvideo,e=this.canuselink,i=[],t&&i.push({id:"library",name:"素材库",url:"",show:!0}),e&&i.push({id:"link",name:"视频链接",url:"",show:!0}),i),tab:this.canusetxvideo&&"library"===this.tabselected?"library":"link",searchData:"",searchKey:"",dialogShow:!1,conf:{library:a(n,this.scene,this.allowChooseLength),link:g(this.allowChooseLength)},hoverItem:null,itemHeight:114,dialogHeight:0,lastHeight:0,height:0,linkHeight:0,oriLibHeight:0,dialogTitle:o,loadingHeight:0}},created:function(){this.searchInfo={begin:0,cnt:0,count:0,list:[]}},mounted:function(){!0===this.value&&this.show()
var t=this.$refs.videoDialog,e=t&&t.$refs.main,i=e&&e.querySelector(".weui-desktop-dialog")
this.dialogHeight=s(i)
var n=this.$refs.libPanel
this.oriLibHeight=s(n,!0)
var o=this
window.addEventListener("resize",function(){o.timer&&clearTimeout(o.timer),o.timer=setTimeout(function(){o.needResize()&&"library"===o.tab&&o.getVideoData(o.conf.library.currentPage).then(function(t){o.pageChangeSucCb(t)}).catch(function(t){console.log(t),o.pageChangeErrCb()})},250)})},methods:{initData:function(){this.conf={library:a(this.videoList,this.scene,this.allowChooseLength),link:g(this.allowChooseLength)},this.hoverItem=null,this.tab="library"},closeDialog:function(){this.hide(),this.$emit("close")},show:function(){!1===this.dialogShow&&(this.dialogShow=!0)},hide:function(){!0===this.dialogShow&&(this.dialogShow=!1)},uploadVideo:function(){window.openUrl("/cgi-bin/appmsg?t=media/videomsg_edit&action=video_edit&type=15",{},!0)},onSearch:function(t){var e=this
this.conf[this.tab].showSelected&&this.changeViewToAllVideo(),"string"==typeof t?(this.searchInfo={begin:0,cnt:0,count:0,list:[]},this.searchKey=t):this.searchKey="",this.conf[this.tab].currentPage=1,this.getVideoData(1).then(function(t){e.pageChangeSucCb(t)}).catch(function(t){console.log(t),e.pageChangeErrCb()})},tabChange:function(t){var e=this
if("library"===t)this.needResize()&&this.getVideoData(this.conf.library.currentPage).then(function(t){e.pageChangeSucCb(t)}).catch(function(t){console.log(t),e.pageChangeErrCb()})
else if("link"===t){var i=this.$refs.libPanel.offsetHeight-100
this.linkHeight=i+"px"}this.tab=t},needResize:function(){var t=!1,e=window.innerHeight-this.dialogHeight-80,i=Math.floor(e/this.itemHeight)
i=i<3?3:i,e/this.itemHeight-i!=0&&(e=this.itemHeight*i),e!==this.lastHeight&&(t=!0),this.conf.library.pageLen=2*i,this.lastHeight=e,this.height=e+"px"
var n=e+24.5
if(this.loadingHeight=n+"px",0!==this.oriLibHeight){var o=this.oriLibHeight+e-100
this.linkHeight=o+"px"}if(this.searchKey)this.searchInfo.len=Math.ceil(this.searchInfo.count/this.conf.library.pageLen)
else if(0<this.conf[this.tab].totalCount){var s=Math.ceil(this.conf[this.tab].totalCount/this.conf[this.tab].pageLen)
this.conf[this.tab].currentPage>s&&(this.conf[this.tab].currentPage=s)}return t},getVideoData:function(n){var o=this
this.conf.library.loading=!0
var t=void 0
"ueditor"===this.scene?(t="&type=15&begin="+this.conf.library.pageLen*(n-1)+"&f=json",t="/cgi-bin/video_mgr?action=get_video_list&offset="+this.conf.library.pageLen+t):"morevideo"===this.scene?(t="/cgi-bin/appmsg?action=list_pub_video&count="+this.conf.library.pageLen,this.searchKey?(n>this.searchInfo.len&&(this.conf[this.tab].currentPage=this.searchInfo.len,n=this.searchInfo.len),t+="&begin="+this.searchInfo.begin+"&query="+this.searchKey):t+="&begin="+this.conf.library.pageLen*(n-1)):(t="&type=15&begin="+this.conf.library.pageLen*(n-1)+"&f=json",t="/cgi-bin/appmsg?action=list&count="+this.conf.library.pageLen+t)
function s(t){o.conf.library.loading=!1,t({app_msg_cnt:a.count,app_msg_list:a.list.slice((n-1)*o.conf.library.pageLen,n*o.conf.library.pageLen)})}var a=this.searchInfo
return this.searchKey&&(a.list.length>=n*this.conf.library.pageLen||a.begin>a.cnt)?new Promise(s):new Promise(function(e,i){r.get({url:t},function(t){t&&t.base_resp&&0===t.base_resp.ret?o.searchKey?(0===a.begin&&(a.count=t.app_msg_cnt,a.cnt=t.app_msg_cnt,a.len=Math.ceil(t.app_msg_cnt/o.conf.library.pageLen)),a.begin+=o.conf.library.pageLen,a.list=a.list.concat(t.app_msg_list),a.begin<=a.cnt?a.count-=o.conf.library.pageLen-t.app_msg_list.length:(0===t.app_msg_list.length&&(o.conf[o.tab].currentPage--,n--),a.count=a.list.length),a.begin>=a.cnt||a.list.length>=n*o.conf.library.pageLen?s(e):o.getVideoData(n).then(e).catch(i)):(o.conf.library.loading=!1,e(t)):(o.conf.library.loading=!1,i(t))})})},pageChange:function(t){var e=this,i=t.currentPage
this.conf[this.tab].currentPage=i,this.getVideoData(i).then(function(t){e.pageChangeSucCb(t)}).catch(function(t){console.log(t),e.pageChangeErrCb()})},pageChangeSucCb:function(t){var e=this,i=void 0,n=this.conf[this.tab].selectedData
if("morevideo"===this.scene)this.conf.library.totalCount=t.app_msg_cnt,i=(i=t.app_msg_list).map(function(t){return t.status=t.video_status,t.canSelect=!0,t})
else{i=t.app_msg_info.file_item||t.app_msg_info.item,Array.isArray(i)&&(i=(i=i.map(function(t){return h({},t,t.multi_item?t.multi_item[0]:{})})).map(function(t){return t.update_time=t.create_time,t.video_id=t.content,t.vid=t.content,t.play_length=e.durationStr2Sec(t.duration),t.is_mp_video*=1,t.aid=t.content,t.url=e.getPlayurlByVid(t.vid,t.is_mp_video),t})),this.conf.library.totalCount=t.app_msg_info.file_cnt.video_msg_cnt||t.app_msg_info.file_cnt.video_cnt
for(var o=0;o<i.length;o++){var s=i[o],a=d.getVideoStatus(s)
switch(s.statusId=a,s.canSelect=!0,a){case 0:s.statusMsg="审核中",s.statusInfo="该视频在审核中，审核通过后才能选择"
break
case 10:s.statusMsg="修改审核中"
break
case 1:s.statusMsg="资料不完整"
break
case 2:s.statusMsg="审核不通过",s.statusInfo="该视频审核不通过，无法被选择"
break
case 8:s.statusMsg="修改审核失败"
break
case 6:s.statusMsg="原创声明失败"
break
case 7:s.statusMsg="原创校验失败"
break
case 4:s.statusMsg="转码中",s.statusInfo="该视频在转码中，转码完成并审核通过后才能选择"
break
case 9:s.statusMsg="已下架"
break
case 5:s.statusMsg="转码失败",s.statusInfo="该视频转码失败，无法被选择，请前往素材库重新上传"
break
default:s.statusMsg=""}var r=d.canModify(s)
1!=+s.is_new_video||r?1==+s.is_new_video||s.content_url||(s.statusInfo=s.statusInfo?s.statusInfo:"转码完成后才可使用",s.canSelect=!1):(s.statusInfo=s.statusInfo?s.statusInfo:"该视频目前无法被选择",s.canSelect=!1),1===s.video_ori_status&&s.is_new_video&&3===s.status?s.tag="原创":2===s.video_ori_status&&s.is_new_video&&3===s.status&&(s.tag="转载")}}i.forEach(function(t){t.duration=e.formatDuration(t.duration),e.$set(t,"checked",!1)}),n.forEach(function(t){e.$set(t,"checked",!0)})
for(var c=0;c<n.length;c++)for(var l=0;l<i.length;l++)n[c].aid===i[l].aid&&(i[l].checked=!0)
this.conf.library.list=i},pageChangeErrCb:function(){this.$tipsErr("系统错误，请稍后重试")},searchVideo:function(){this.conf.link.linkInputStatus="normal",this.conf.link.showLinkInfo=!1
var r=this.conf.link.inputLink
if(""!==r.length){if(!(0<=this.getLinkType(r)))return this.conf.link.loading=!1,this.conf.link.showLinkInfo=!1,void(this.conf.link.linkInputStatus="warn")
this.conf.link.linkInputStatus="normal",this.conf.link.loading=!0
var c=this
this.convert_url(r,function(t){if(r===c.conf.link.inputLink){if(!t||!t.vidInfo||0===t.vidInfo.length)return c.conf.link.showLinkInfo=!0,void(c.conf.link.loading=!1)
for(var e=t.vidInfo,i={return_count:0,video_info:[],total:e.length},n=0;n<e.length;n++){var o={title:"",cover:"",duration:"",is_new_video:1,video_ori_status:4,status:3,source:"file"},s=e[n],a=s.vid
1==+s.is_mp_video?(2==+s.status?(o.statusMsg="审核失败",o.statusInfo="该视频审核不通过，无法被选择"):9==+s.status?(o.statusMsg="已下架",o.statusInfo="该视频已下架，无法被选择"):0==+s.status?(o.statusMsg="审核中",o.statusInfo="该视频在审核中，审核通过后才能选择"):10==+s.status&&(o.statusMsg="已被发布者删除",o.statusInfo="该视频已被发布者删除"),c.getMpVideoInfoByVid(a,i,o,r,s)):c.getTxVideoInfoByVid(a,i,o,r,s)}}},null,function(){r===c.videoLink&&(c.linkLoading=!1,c.linkInputStatus="warn",c.$tipsErr("该网址存在错误，请填写正确的腾讯视频网址"))})}},getMpVideoInfoByVid:function(i,n,o,s,a){var r=this
c.getMpVideoInfo({vid:i,onSuccess:function(t){if(s===r.conf.link.inputLink){n.return_count++
var e=JSON.parse(JSON.stringify(o))
e.id=n.return_count,e.title=t.data.title,e.play_length=t.data.time||0,e.duration=parseInt(t.data.time||0,10),e.cover=t.data.cover,e.video_id=i,e.is_mp_video=1,e.ori_status=a.ori_status,e.hit_nickname=a.hit_nickname,e.aid=e.video_id,e.statusMsg=o.statusMsg||t.err_msg,e.statusInfo=e.statusMsg&&""!==e.statusMsg?e.statusInfo||"该视频无法被选择":"",e.checked=r.isVideoChecked(e),e.canSelect=""===e.statusMsg,n.video_info.push(e),n.return_count===n.total&&(r.conf.link.list=n.video_info,r.conf.link.loading=!1,r.conf.link.showLinkInfo=!0,1===n.total&&(r.isVideoChecked(n.video_info[0])||r.selectVideo(n.video_info[0])))}},onError:function(){s===r.conf.link.inputLink&&(n.return_count++,n.return_count===n.total&&0===n.video_info.length&&(r.$tipsErr("获取视频失败，请重试"),r.conf.link.loading=!1))}})},getTxVideoInfoByVid:function(i,n,o,s){var a=this
c.getInfoByVid({vid:i,onSuccess:function(t){if(s===a.conf.link.inputLink){n.return_count++
var e=JSON.parse(JSON.stringify(o))
e.id=n.return_count,e.title=t.data.title,e.play_length=t.data.time||0,e.duration=parseInt(t.data.time||0,10),e.cover=t.data.p16_9,e.video_id=i,e.is_mp_video=0,e.aid=e.video_id,e.statusMsg=t.errMsg,e.checked=a.isVideoChecked(e),e.canSelect=""===e.statusMsg,n.video_info.push(e),80==+t.retCode&&1==+t.oriData.exem&&(n.video_info[n.video_info.length-1].err_msg="",n.video_info[n.video_info.length-1].statusMsg="",n.video_info[n.video_info.length-1].canSelect=!0),e.statusInfo=e.statusMsg&&""!==e.statusMsg?e.statusInfo||"该视频无法被选择":"",n.return_count===n.total&&(a.conf.link.list=n.video_info,a.conf.link.loading=!1,a.conf.link.showLinkInfo=!0,1===n.total&&(a.isVideoChecked(n.video_info[0])||a.selectVideo(n.video_info[0])))}},onError:function(){s===a.conf.link.inputLink&&(n.return_count++,n.return_count===n.total&&1===a.conf.link.allowChooseLength&&(a.$tipsErr("获取视频失败，请重试"),a.conf.link.loading=!1))}})},getLinkType:function(t){return t=t.replace(/^\s+|\s+$/g,"").replace("http://","").replace("https://",""),/^(v|cache.tv|m.v)\.qq\.com([\/?].*)*$/i.test(t)?0:/^mp\.weixin\.qq\.com\/video\?.*$/i.test(t)?1:/^mp\.weixin\.qq\.com\/s[\?\/].+$/i.test(t)?2:/^mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl.*$/i.test(t)?3:-1},convert_url:function(t,e,i,n){var o=this.getLinkType(t)
i=i||{},0===o?this.handleTencentVideo(t,e,i,n):2===o?this.handleAppmsgUrl(t,e):1===o?this.handleVideoDetailUrl(t,e):3===o&&this.handleMpPlayerUrl(t,e)},handleTencentVideo:function(i,n,t,e){var o="",s=null,a=i.match(new RegExp("(^|&|\\\\?)vid=([^&]+)(&|$|#)")),r=i.match(new RegExp("(^|&|\\\\?)cid=([^&]+)(&|$|#)")),c=i.match(new RegExp("(http://)?(cache.tv|m.v|v)\\.qq\\.com/cover[^/]*/\\w+/([^/]*)\\.html")),l=i.match(new RegExp("(http://)?(cache.tv|m.v|v)\\.qq\\.com/prev[^/]*/\\w+/([^/]*)\\.html")),h=i.match(/\/(\w{15})\.html/)
if(a)s=a,-1!==(o=encodeURIComponent(s[2])).indexOf("_")&&(o=o.split("_")[0]),!/[a-zA-Z0-9]{11}/.test(o)&&f&&f.monitor&&f.monitor(94,"vid:"+o+";url="+i,39),n({vidInfo:[{vid:o,is_mp_video:0}]})
else if(r||c||l||h){var d=null
d=3<=(s=r||c||l||h).length?encodeURIComponent(s[2]):encodeURIComponent(s[1]),u({url:"https://data.video.qq.com/fcgi-bin/data?tid=554&appid=20001184&appkey=85a707e3a07cc44d&callback=QZOutputJson&otype=json&idlist="+d,timeout:1e4,callbackName:"QZOutputJson",callback:function(t){var e=0<arguments.length&&void 0!==t?t:{}
try{-1!==(o=e.results[0].fields.video_ids[0]).indexOf("_")&&(o=o.split("_")[0]),!/[a-zA-Z0-9]{11}/.test(o)&&f&&f.monitor&&f.monitor(94,"vid:"+o+";url="+i,39),n({vidInfo:[{vid:o,is_mp_video:0}]})}catch(t){n({vidInfo:[]})}},onerror:function(){n({vidInfo:[]})}})}else(o=this.getVidFromUrl(i))?(-1!==o.indexOf("_")&&(o=o.split("_")[0]),!/[a-zA-Z0-9]{11}/.test(o)&&f&&f.monitor&&f.monitor(94,"vid:"+o+";url="+i,39),n({vidInfo:[{vid:o,is_mp_video:0}]})):e&&e(-1)},getUrlParam:function(t,e){var i=t+"=",n=(e=e||document.location.toString()).indexOf(i)
if(-1===n)return""
var o=e.indexOf("&",n),s=e.indexOf("?",n)
return-1!==s&&(-1===o||s<o)&&(o=s,s=e.indexOf("#",n)),-1!==s&&(-1===o||s<o)&&(o=s),-1===o?e.substring(n+i.length):e.substring(n+i.length,o)},getVidFromUrl:function(t){t=t||window.location.toString()
var e=this.getUrlParam("vid",t),i=void 0
if(e||(i=t.match(/\/\w{15}\/(\w+)\.html/))&&(e=i[1]),!e){var n=t.match(/\/page\/\w{1}\/\w{1}\/\w{1}\/(\w+)\.html/),o=t.match(/\/(page|play)\/+(\w{11})\.html/),s=t.match(/\/(page)\/(\w+)\.html/)
n?e=n[1]:o?e=o[2]:s&&(e=s[2])}return e||(i=t.match(/\/boke\/gplay\/\w+_\w+_(\w+)\.html/))&&(e=i[1]),encodeURIComponent(e)},handleAppmsgUrl:function(t,e){r.get({url:"/cgi-bin/video_mgr?action=get_vid_list&url="+window.encodeURIComponent(t)},function(t){t&&t.vid_info_list&&0<t.vid_info_list.length?e({vidInfo:t.vid_info_list}):e()},function(){e()})},handleVideoDetailUrl:function(t,e){var i=t.match(/[\?&]vid\=([^&]*)/)
i&&i[1]?e({vidInfo:[{vid:i[1],is_mp_video:0}]}):e()},handleMpPlayerUrl:function(t,e){var i=t.match(/[\?&]vid\=([^&]*)/)
i&&i[1]?e({vidInfo:[{vid:i[1],is_mp_video:1}]}):e()},durationStr2Sec:function(t){if(!t)return 0
for(var e=(t=t.replace(/：/g,":")).split(":"),i=0,n=1,o=e.length-1;0<=o;o--)i+=e[o]*n,n*=60
return i},getPlayurlByVid:function(t,e,i,n,o){return o=!0===o,i=i||500,n=n||375,e?"https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&action=mpvideo&auto=0&vid="+t:o?"https://v.qq.com/txp/iframe/player.html?vid="+t+"&width="+i+"&height=auto":"https://v.qq.com/iframe/preview.html?width="+i+"&height="+n+"&auto=0&vid="+t},isWeiboVideo:function(t){return!(!t||!t.substr)&&"04"===t.substr(1,2)},selectVideo:function(t){if(!1!==t.canSelect){var e=this.conf[this.tab],i=e.allowChooseLength
if(e.showSelected||this.selectedVideo.length!==i||this.isVideoChecked(t)||1===i)if(1===e.allowChooseLength){for(var n=0;n<e.list.length;n++)e.list[n].checked=e.list[n].aid===t.aid
t.checked=!0,e.selectedData=[t]}else{for(var o=!t.checked,s=0;s<e.list.length;s++)e.list[s].aid===t.aid&&(e.list[s].checked=o)
if(!e.showSelected)if(this.isVideoChecked(t)){var a=this.selectedVideoIdList.indexOf(t.aid)
e.selectedData.splice(a,1)}else{var r=h({},t)
r.title=this.formatTitle(r.title),e.selectedData.push(r)}for(var c=0;c<e.selectedData.length;c++)e.selectedData[c].aid===t.aid&&(e.selectedData[c].checked=o)}else this.$tipsErr(l.sprintf("最多选择%s个视频",i))}},changeViewToSelectedVideo:function(){this.conf[this.tab].showSelected=!0},changeViewToAllVideo:function(){this.conf[this.tab].showSelected=!1
for(var t=[],e=0;e<this.selectedVideo.length;e++)this.selectedVideo[e].checked&&t.push(this.selectedVideo[e])
this.conf[this.tab].selectedData=t},submit:function(){var t=this.conf[this.tab].selectedData.filter(function(t){return t.checked})
if(0!==t.length){if("library"===this.tab)"morevideo"===this.scene?this.$emit("select",t,this.tab,this.scene):1===this.conf[this.tab].allowChooseLength?this.$emit("select",JSON.parse(JSON.stringify(t[0])),this.tab):this.$emit("select",JSON.parse(JSON.stringify(t)),this.tab)
else{for(var e=this.getLinkType(this.conf.link.inputLink),i=t,n=[],o=0;o<i.length;o++){if(0===e&&this.isWeiboVideo(i[o].video_id))return void this.$tipsErr("该链接为腾讯微博视频网址，此处引用视频只支持已发布的微信公众号链接、视频详情链接或者腾讯视频链接")
var s={height:375,width:500,vid:i[o].video_id,subtype:e,url:this.getPlayurlByVid(i[o].video_id,+i[o].is_mp_video),title:i[o].title,duration:i[o].duration,play_length:i[o].play_length,cover:i[o].cover,video_id:i[o].video_id,content:i[o].video_id,is_mp_video:+i[o].is_mp_video,video_ori_status:i[o].ori_status,hit_nickname:i[o].hit_nickname}
n.push(s)}1===this.conf[this.tab].allowChooseLength?this.$emit("select",JSON.parse(JSON.stringify(n[0])),this.tab):this.$emit("select",JSON.parse(JSON.stringify(n)),this.tab)}this.hide()}},dialogVisibleChange:function(t){var e=this
if(t){if(this.initData(),this.needResize(),"library"===this.tab&&0<this.conf.library.selectedData.length){this.conf[this.tab].showSelected=!0
for(var i=this.conf.library.selectedData,n=0;n<i.length;n++)if(i[n].duration=this.formatDuration(i[n].duration),1===i[n].deleted){this.$tipsErr("已选择视频中包含已删除内容")
break}}this.getVideoData(1).then(function(t){e.pageChangeSucCb(t)}).catch(function(t){console.log(t),e.pageChangeErrCb()})}},isVideoChecked:function(t){return-1<this.selectedVideoIdList.indexOf(t.aid)},isVideoDisabled:function(t){return this.selectedVideo.length===this.conf[this.tab].allowChooseLength&&!this.isVideoChecked(t)&&1!==this.conf[this.tab].allowChooseLength||!t.canSelect},isCheckboxShow:function(){return 1<this.conf[this.tab].allowChooseLength},formatDuration:function(t){if(!t)return"00:00"
if(t&&"string"==typeof t&&-1<t.indexOf(":"))return 2===t.split(":").length&&4===t.length?"0"+t:t
t=parseInt(t,10)
var e=Math.floor(t/60/60)
t-=60*e*60
var i=Math.floor(t/60),n=t-60*i
return n<10&&(n="0"+n),i<10&&(i="0"+i),0<e?e+":"+i+":"+n:i+":"+n},formatTitle:function(t){return t.replace(/<\/?em>/g,"")}},computed:{submitBtnDisabled:function(){return 0===this.conf[this.tab].selectedData.filter(function(t){return t.checked}).length},selectedItemsShow:function(){return 1<this.conf.link.allowChooseLength},selectedLength:function(){return this.conf[this.tab].selectedData.filter(function(t){return t.checked}).length},selectedVideo:function(){return this.conf[this.tab].selectedData},selectedVideoIdList:function(){for(var t=[],e=0;e<this.selectedVideo.length;e++)t.push(this.selectedVideo[e].aid)
return t},showTabChoose:function(){return this.canuselink&&this.canusetxvideo},showSelected:function(){return this.conf[this.tab].showSelected},showSearch:function(){return"morevideo"===this.scene}},watch:{dialogShow:function(t){this.$emit("input",t)},value:function(t){!0===t?this.show():this.hide()}},filters:{formatUpdateTime:function(t){return o.formatDate(t,"YYYY-MM-DD hh:mm")},getVideoLength:function(t){return t.filter(function(t){return t.checked}).length}}})})
define("pages/modules/media_dialog/video_dialog/video_dialog.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.more-video__wrp {  position: relative;}.more-video__wrp .weui-desktop-pagination {  padding-top: 0;}.more-video__wrp .weui-desktop-tab__navs {  padding: 0 32px;}.more-video__title {  font-size: 16px;  padding: 20px 0;  overflow: hidden;}.more-video__title .weui-desktop-btn {  float: right;  margin-left: 15px;}.more-video__title .weui-desktop-search {  width: 250px;  float: right;}.more-video__lib {  padding: 0 32px;}.more-video__list {  height: 440px;  overflow-y: hidden;  overflow-x: hidden;  margin-right: -20px;}.more-video__list_single {  text-align: center;}.more-video__list_single .more-video__item {  float: none;  text-align: left;  display: inline-block;}.more-video__item {  border: 2px solid transparent;  box-sizing: border-box;  float: left;  height: 94px;  position: relative;  margin-bottom: 20px;  width: 50%;}.more-video__item .weui-desktop-form__check-label {  position: absolute;  left: 10px;  top: 10px;}.more-video__item .weui-desktop-icon-checkbox {  border: 1px solid #ffffff;  background-color: rgba(0, 0, 0, 0.2);  -webkit-border-radius: 2px;  border-radius: 2px;  width: 24px;  height: 24px;  -webkit-box-sizing: border-box;  box-sizing: border-box;}.more-video__item .weui-desktop-form__checkbox:checked + .weui-desktop-icon-checkbox {  background-color: #44B549;}.more-video__item .weui-desktop-form__checkbox:checked + .weui-desktop-icon-checkbox::before {  margin-top: 7px;  border-color: #FFFFFF;}.more-video__item_selected {  border-color: transparent;}.more-video__item_selected .more-video__item-wrp::before {  content: \"\";  display: block;  width: 100%;  height: 100%;  border: 2px solid #07C160;  background-color: rgba(7, 193, 96, 0.1);  border-radius: 2px;  position: absolute;  left: 50%;  top: 50%;  -ms-transform: translate(-50%, -50%);      transform: translate(-50%, -50%);}.more-video__item_disabled .more-video__item-wrp::after {  content: \"\";  display: block;  position: absolute;  left: 0;  top: 0;  right: 0;  bottom: 0;  background: rgba(255, 255, 255, 0.5);  z-index: 10;}.more-video__item_disabled .more-video__item-wrp:hover:before {  display: none;}.more-video__item_disabled .weui-desktop-form__check-label {  opacity: 0;}.more-video__item-wrp {  height: 100%;  display: -ms-flexbox;  display: flex;  margin-right: 20px;  border-radius: 2px;  border: 1px solid #E5E5E5;  box-sizing: border-box;  position: relative;  z-index: 2;  cursor: pointer;}.more-video__item-wrp:hover:before {  content: \"\";  display: block;  width: 100%;  height: 100%;  border: 2px solid #07C160;  border-radius: 2px;  position: absolute;  left: 50%;  top: 50%;  -ms-transform: translate(-50%, -50%);      transform: translate(-50%, -50%);}.weui-desktop-simple-video__mask.weui-desktop-simple-video__mask_suc {  cursor: pointer;  padding: 0 8px;  border-radius: 16px;  height: 20px;  line-height: 20px;  bottom: 10px;  left: 10px;  display: -ms-flexbox;  display: flex;  -ms-flex-align: center;      align-items: center;}.weui-desktop-simple-video__mask {  position: absolute;  display: block;  text-align: center;  background: rgba(0, 0, 0, 0.6);}.icon-svg-modules-media-vedio-player {  background-image: url(\"data:image/svg+xml;charset=utf8, %3Csvg width='8' height='8' viewBox='0 0 8 8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M.726 7.934l6.892-3.488a.5.5 0 0 0 0-.892L.726.066A.5.5 0 0 0 0 .513v6.975a.5.5 0 0 0 .726.446z' fill-rule='nonzero' fill='%23FFF'/%3E%3C/svg%3E\");  width: 8px;  height: 8px;  margin-right: 4px;}.weui-desktop-simple-video__duration {  font-style: normal;  color: #fff;  vertical-align: middle;  font-size: 12px;}.more-video__item-img {  width: 160px;  height: 100%;  background-position: center center;  background-size: cover;  -ms-flex-negative: 0;      flex-shrink: 0;}.more-video__item-content {  padding: 10px 20px;  height: 100%;  box-sizing: border-box;  display: -ms-flexbox;  display: flex;  -ms-flex-direction: column;      flex-direction: column;  -ms-flex-pack: justify;      justify-content: space-between;  -ms-flex: 1;      flex: 1;}.more-video__item-title {  display: -webkit-box;  -webkit-line-clamp: 2;  -webkit-box-orient: vertical;  overflow: hidden;  text-overflow: ellipsis;  word-break: break-all;}.more-video__item-title em {  color: #44B549;  font-style: normal;}.more-video__item-desc {  color: #9A9A9A;}.more-video__footer {  position: relative;}.more-video__footer .weui-desktop-btn {  margin-right: 20px;}.more-video__footer .weui-desktop-btn:last-child {  margin-right: 0;}.more-video__item-status {  margin-left: 5px;  float: right;}.more-video__item-status-desc {  position: absolute;  width: 100%;  line-height: 50px;  padding: 0 15px;  box-sizing: border-box;  background-color: rgba(250, 250, 250, 0.95);  color: #9A9A9A;  z-index: 11;}.more-video__footer-selection {  position: absolute;  left: 0;  line-height: 36px;}.more-video__footer-selection span {  margin: 0 4px;  color: #576B95;  cursor: pointer;}.more-video__loading {  text-align: center;  height: 440px;  display: -ms-flexbox;  display: flex;  -ms-flex-align: center;      align-items: center;  -ms-flex-pack: center;      justify-content: center;}.more-video__empty {  height: 100%;  display: -ms-flexbox;  display: flex;  -ms-flex-align: center;      align-items: center;  -ms-flex-pack: center;      justify-content: center;  color: #9A9A9A;}.more-video__link {  margin: 60px 32px 40px;}.more-video__link .weui-desktop-form__label {  width: 7em;}.more-video__link .weui-desktop-form__control-group {  display: -ms-flexbox;  display: flex;  width: 650px;  margin: 0 auto 30px;}.more-video__link .weui-desktop-form__control-group .weui-desktop-form__controls {  -ms-flex: 1;      flex: 1;  display: -ms-flexbox;  display: flex;  -ms-flex-align: start;      align-items: flex-start;}.more-video__link .weui-desktop-form__control-group .weui-desktop-btn_default {  margin-left: -1px;}.more-video__link .weui-desktop-form__input-area {  -ms-flex: 1;      flex: 1;}";});define("vue-weui/src/utils/loadscript.js",[],function(e,o,t){"use strict"
var y=1
t.exports={load:function e(o){var n=0<arguments.length&&void 0!==o?o:{},t=void 0
t="number"!=typeof n.retry?1:n.retry
var r=document.createElement("script"),a=document.head||document.getElementsByTagName("head")[0]||document.documentElement,i=n.url+"&t="+Math.random(),d=n.callbackName,l="uninitialized",u=void 0
u=void 0===n.successCode?200:n.successCode
var c=void 0
c=void 0===n.timeoutCode?500:n.timeoutCode
var s=void 0
s=void 0===n.scriptErrorCode?400:n.scriptErrorCode
function f(e){null!==r&&!0!==m&&(m=!0,v&&(clearTimeout(v),v=null),r.onload=null,r.onreadystatechange=null,r.onerror=null,a&&r.parentNode&&a.removeChild(r),r=null,d&&-1===d.indexOf(".")&&(window[d]=null),e!==u&&"loaded"!==l&&"function"==typeof n.onerror&&n.onerror(e))}var m=!1,v=null
if(d&&"function"==typeof n.callback){var p=d;-1===d.indexOf(".")&&(window[d]&&(d+=++y),window[d]=function(){for(var e=arguments.length,o=Array(e),t=0;t<e;t++)o[t]=arguments[t]
l="loaded",n.callback.apply(null,o)}),i=i.replace("="+p,"="+d)}r.onreadystatechange=function(){var e=navigator.userAgent.toLowerCase();-1===e.indexOf("opera")&&-1!==e.indexOf("msie")&&!/loaded|complete/i.test((void 0).readyState)||f("loaded"===l?u:s)},r.onload=r.onreadystatechange,r.onerror=function(){if(0<t)return n.retry=t-1,v&&(clearTimeout(v),v=null),void e(n)
f(s)},n.timeout&&(v=setTimeout(function(){f(c)},parseInt(n.timeout,10))),l="loading",r.charset="utf-8",setTimeout(function(){r.src=i
try{a.insertBefore(r,a.lastChild)}catch(e){}},0)}}})
define("pages/modules/media_dialog/video_dialog/video_dialog.tpl.js",[],function(e,i,o){return'<mp-dialog ref="videoDialog" :title=\'dialogTitle\' :width="960" v-model="dialogShow" @close="closeDialog" @visible-change="dialogVisibleChange">  <div class="more-video__wrp">        <mp-tab :tabs="tabs" :selected="tab" @click="tabChange" v-if="showTabChoose" />        <div class="more-video__lib" v-show="tab === \'library\'" ref="libPanel">      <div class="more-video__title" v-if="conf.library.showUpload || showSearch">        <mp-button @click="uploadVideo" v-if="conf.library.showUpload">本地上传</mp-button>        <mp-search v-if="showSearch" placeholder="输入标题关键词" v-model="searchData" clear @search="onSearch" @clear="onSearch"></mp-search>      </div>            <p class="weui-desktop-media-tips weui-desktop-media-tips_loading"  v-show="conf.library.loading && !conf.library.showSelected" :style="{ height: loadingHeight }">加载中</p>            <p class="weui-desktop-media-tips" v-if="showSearch" v-show="searchKey && !conf.library.showSelected && !conf.library.loading && conf.library.list.length === 0" :style="{ height: loadingHeight }">没有匹配的搜索结果，只可搜索已群发的视频 <a href="javascript:;" @click="searchData = \'\', onSearch()">返回全部</a></p>            <ul ref="videoList" class="more-video__list" v-show="!conf.library.showSelected && !conf.library.loading && !(searchKey && conf.library.list.length === 0)" :style="{ height: height }">        <li class="more-video__empty" v-if="conf.library.list.length === 0">暂无视频</li>        <li :class="{          \'more-video__item\': true,          \'more-video__item_selected\': isVideoChecked(item) && item.checked && item.canSelect,          \'more-video__item_disabled\': isVideoDisabled(item) && !item.checked        }" v-for="item in conf.library.list" @mouseenter="hoverItem = item" @mouseleave="hoverItem = null">          <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)">            <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>            <div class="more-video__item-content">              <div class="more-video__item-title"><b class="weui-desktop-key-tag" v-show="item.tag">{{item.tag}}</b><span v-html="item.title"></span></div>              <div class="more-video__item-desc">                {{item.update_time}}                                <span class="more-video__item-status">{{item.statusMsg}}</span>              </div>            </div>                        <div class="more-video__item-status-desc" v-show="hoverItem === item">{{item.statusInfo}}</div>            <mp-checkbox :value="isVideoChecked(item) && item.checked && item.canSelect" v-bind:disabled="isVideoDisabled(item) && !item.checked" v-show="isCheckboxShow(item)"></mp-checkbox>            <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc" v-if="item.duration">              <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>            </span>          </div>        </li>      </ul>            <ul class="more-video__list" v-show="conf.library.showSelected" :style="{ height: loadingHeight}">        <li class="more-video__empty" v-if="selectedVideo.length === 0">暂无视频</li>        <li :class="{          \'more-video__item\': true,          \'more-video__item_selected\': isVideoChecked(item) && item.checked        }" v-for="item in selectedVideo">          <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)">            <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>            <div class="more-video__item-content">              <div class="more-video__item-title">{{ item.title }}</div>              <div class="more-video__item-desc">                {{item.update_time | formatUpdateTime}}                <span class="more-video__item-status" v-if="item.deleted === 1">已删除</span>              </div>            </div>            <mp-checkbox :value="isVideoChecked(item) && item.checked"></mp-checkbox>            <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc">              <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>            </span>          </div>        </li>      </ul>      <mp-pagination        v-show="!conf.library.showSelected && !conf.library.loading"        :per-page="conf.library.pageLen"        :total-num="conf.library.totalCount"        :current="conf.library.currentPage"        :show-endpage="!searchKey"        :show-jumper="!searchKey"        @page-change="pageChange"      ></mp-pagination>    </div>        <div class="more-video__link" v-show="tab === \'link\'" :style="{ height: linkHeight}">      <mp-form v-show="!conf.link.showSelected" @submit.native.prevent>        <mp-form-item label="视频/图文网址">          <mp-input type="text"          :status="conf.link.linkInputStatus"          :require="true"          v-model="conf.link.inputLink"          placeholder="支持微信公众号文章链接，视频详情页链接和腾讯视频链接"          @keydown.enter="searchVideo">          <span slot="message">只支持已发布的微信公众号链接、视频详情页链接和腾讯视频链接</span>          </mp-input>          <mp-button @click="searchVideo" :disabled="conf.link.inputLink === \'\'">确定</mp-button>        </mp-form-item>      </mp-form>            <p class="weui-desktop-media-tips weui-desktop-media-tips_loading" style="height: 385px;" v-show="conf.link.loading && !conf.link.showSelected && !conf.link.showLinkInfo">加载中</p>      <ul class="more-video__list" :class="{\'more-video__list_single\': conf.link.list.length === 1}" v-show="!conf.link.showSelected && !conf.link.loading && conf.link.showLinkInfo">        <li class="more-video__empty" v-show="conf.link.list.length === 0">暂无视频</li>        <li :class="{          \'more-video__item\': true,          \'more-video__item_selected\': isVideoChecked(item) && item.checked,          \'more-video__item_disabled\': isVideoDisabled(item)        }" v-for="item in conf.link.list" :key="item.aid" @mouseenter="hoverItem = item" @mouseleave="hoverItem = null">          <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)">            <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>            <div class="more-video__item-content">              <div class="more-video__item-title">{{item.title}}</div>              <div class="more-video__item-desc">                {{item.update_time | formatUpdateTime}}                <span class="more-video__item-status">{{item.statusMsg}}</span>              </div>            </div>            <div class="more-video__item-status-desc" v-show="hoverItem === item">{{item.statusInfo}}</div>            <mp-checkbox :value="isVideoChecked(item) && item.checked" v-bind:disabled="isVideoDisabled(item)" v-show="isCheckboxShow(item)"></mp-checkbox>            <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc">              <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>            </span>          </div>        </li>      </ul>              <ul class="more-video__list" v-show="conf.link.showSelected">        <li class="more-video__empty" v-if="selectedVideo.length === 0">暂无视频</li>        <li :class="{          \'more-video__item\': true,          \'more-video__item_selected\': isVideoChecked(item) && item.checked        }" v-for="item in selectedVideo" :key="item.aid">          <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)">            <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>            <div class="more-video__item-content">              <div class="more-video__item-title">{{item.title}}</div>              <div class="more-video__item-desc">                {{item.update_time | formatUpdateTime}}                <span class="more-video__item-status" v-if="item.deleted === 1">已删除</span>              </div>            </div>            <mp-checkbox :value="isVideoChecked(item) && item.checked"></mp-checkbox>            <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc">              <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>            </span>          </div>        </li>      </ul>    </div>  </div>  <div slot="footer" class="more-video__footer">    <div class="more-video__footer-selection" v-show="selectedItemsShow">      已选择      <span @click="changeViewToSelectedVideo">{{selectedLength}}/ {{conf[tab].allowChooseLength}}条视频</span>      <span @click="changeViewToAllVideo" v-show="showSelected">返回全部</span>    </div>    <mp-button :disabled="submitBtnDisabled" type="primary" @click="submit">确定</mp-button>    <mp-button type="default" @click="closeDialog">取消</mp-button>  </div></mp-dialog>'})
define("pages/media/modules/video_status/video_status.js",[],function(i,t,e){"use strict"
function _(i){var t=0
if(void 0!==i.create_time&&(t=i.create_time<1453914e3?1:0),0===i.status||1===i.is_mp_video&&void 0!==i.is_mp_video_original_check_finish&&1!==i.is_mp_video_original_check_finish&&3===i.status||3===i.status&&0===i.video_ori_status&&(void 0===i.create_time||!t))return 1===i.is_mp_video&&1===i.is_mp_video_in_huiliu_check?10:0
if(1===i.status)return 1
if(10===i.status)return 10
if(2===i.status)return 1!==i.is_mp_video?2:1===i.is_mp_video&&0!==i.mp_video_xinan_check_result_code?2:1===i.is_mp_video&&0!==i.mp_video_modify_check_result_code?8:2
if(3!==i.status)return 4===i.status?1===i.ext_status?2:4:5===i.status?5:9===i.status?9:-1
var e=Number(i.ori_fail_reason)
return 3===i.video_ori_status&&i.mp_video_fail_detail_wording&&i.is_mp_video||3===i.video_ori_status&&-1<[1,3,5].indexOf(e)||2===i.video_ori_status?1===i.applyori?6:7:3}e.exports={getVideoStatus:function(i){return _(i)},canModify:function(i){var t=_(i)
return 3===t||6===t||7===t||8===t},canPlay:function(i){var t=_(i)
return 3===t||6===t||7===t||8===t},canMsgSend:function(i){var t=_(i)
return 3===t||6===t||7===t}}})
define("pages/media/modules/common/getVinfo.js",["vue-weui/src/utils/loadscript.js","pages/modules/utils/cgi.js"],function(e,i,t){"use strict"
var r=e("vue-weui/src/utils/loadscript.js").load,o=e("pages/modules/utils/cgi.js"),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:""
return i&&i!==16/9?"http://shp.qpic.cn/qqvideo/0/"+e+"/400":"http://shp.qpic.cn/qqvideo_ori/0/"+e+"_496_280/0"},c=function(e,i){var t=""
switch(1*e){case-4:case-5:case-3:t="因版权限制，该视频不支持添加"
break
case 61:t="该视频不存在"
break
case 62:t="该视频已下架"
break
case 63:case 65:case 67:t="视频加载失败"
break
case 69:t="视频格式不支持移动端观看"
break
case 71:case 73:case 74:t="视频加载失败"
break
case 80:switch(1*i){case 1:t="IP地址所在地区暂不支持播放"
break
case 2:default:t="因版权限制，该视频不支持添加"}break
case 81:case 82:t="视频加载失败"
break
case 83:switch(1*i){case-1:t="视频加载失败"
break
case-2:default:t="因版权限制，该视频不支持添加"}break
case 84:default:t="视频加载失败"}return t},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i="https://h5vv.video.qq.com/getvinfo?vid=#vid#&dtype=1&otype=json&callback=video_dynamic_callback&appVer=1&encryptVer=6.3&platform=61001&cKey=#ckey#&sdtfrom=v3060"
i=i.replace("#vid#",e.vid).replace("#ckey#",e.ckey),i+="&device=60401&use_proxy_sdk=0"
var t=+new Date
r({url:i,timeout:1e4,callbackName:"video_dynamic_callback",callback:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=+new Date-t
void 0===i.em&&(i.em=0)
var o="",a=1*i.em,n=void 0
if(1*i.em==0){if(i.exem>0?a=-4:1*i.exem==0&&i.vl&&i.vl.vi&&i.vl.vi[0]&&1*i.vl.vi[0].st==8&&(a=i.preview>0?-5:-3),0!==a||i.vl&&i.vl.vi&&i.vl.vi[0]||(a=-2),0!==a&&(o=c(1*a,1*i.exem)),i.vl&&i.vl.vi&&i.vl.vi[0]){var s=i.vl.vi[0]
if(n={newVid:s.lnk,time:s.td,title:s.ti,width:s.vw,height:s.vh,file_size:s.fs,rate:Math.round(s.fs/1024*8/s.td)},s.ul&&s.ul.ui&&s.ul.ui[0]){var l=s.ul.ui[0],v=l.url+s.fn,d=i.fl,f=""
if(d&&d.cnt>0)for(var u=d.fi,p=0;p<u.length;p++)if(1*u[p].sl==1){f=u[p].name,n.resolution=(u[p].cname||"").replace(/^.*;\((:?.*)P\)$/,"$1")||0
break}n.format=f,n.vt=l.vt
var _=""
1*l.dt==1?_="tflv":1*l.dt!=2&&1*l.dt!=0||(_="mp4"),n.totalUrl=[v,-1!==v.indexOf("?")?"&":"?","vkey=",s.fvkey,"&sdtfrom=","&type=",_,"&platform=","&fmt=",f,"&level=",s.level,"&br=",s.br,"&sp=",s.sp].join("")}}}else o=c(1*a,1*i.exem)
e.onSuc({data:n,oriData:i,cTime:r,errMsg:o||"",retCode:a})},onerror:function(i){var r=void 0,o=+new Date-t
switch(1*i){case 400:r=-22
break
case 500:r=-21
break
default:r=-23}"function"==typeof e.onError&&e.onError(r,{retCode:r,cTime:o,errMsg:""})}})}
t.exports={getQQVideoUrlInfo:n,getInfoByVid:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=void 0,t=void 0
i="function"==typeof e.onSuccess?e.onSuccess:function(){},t="function"==typeof e.onError?e.onError:function(){},o.post({url:"/cgi-bin/getvideockey?",data:{vid:e.vid}},function(r){r&&r.base_resp&&1*r.base_resp.ret==0&&r.ckey?n({vid:e.vid,ckey:r.ckey,onSuc:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
t.data||(t.data={}),t.data.p4_3=a(e.vid,4/3),t.data.p16_9=a(e.vid,16/9),i(t)},onError:function(){t({code:3})}}):t({code:2,ckeyResp:r})},function(){t({code:1})})},getMpVideoInfo:function(e){var i=void 0,t=void 0
i="function"==typeof e.onSuccess?e.onSuccess:function(){},t="function"==typeof e.onError?e.onError:function(){}
var r=0,a="",c=null,n=!1,s=function(e){2===r&&!0!==n&&(n=!0,c&&a||(e="err"),"err"===e?t({resp:{},msg:"系统繁忙，请稍后再试"}):(c.data.cover=a,i(c)))}
o.get({url:"/mp/videoplayer?action=get_mp_video_play_url",data:{__biz:e.biz||"",mid:e.mid||"",idx:e.idx||"",vid:e.vid||""}},function(e){r++
var i=null,t=""
if(e&&e.base_resp&&1*e.base_resp.ret==0)if(1*e.is_mp_video_delete==1)t="该视频已被发布者删除"
else if(1*e.is_mp_video_forbid==1)t="该视频因违规已下架"
else if(1*e.is_mp_video_transing==1)t="正在转码，转码完成后可播放"
else if(1*e.is_mp_video_checking==1)t="审核中"
else if(1*e.is_mp_video_check_fail==1)t="审核失败"
else if(e.url_info&&e.url_info.length>0){var o=e.url_info[0],a=Math.floor(o.duration_ms/1e3)
i={time:a,title:e.title||"",width:o.width,height:o.height,file_size:o.filesize,totalUrl:o.url,rate:Math.round(o.filesize/1024*8/a),cover:""}}else t="系统繁忙，请稍后再试"
else t="当前视频不存在，暂无法观看"
i||(i={cover:""}),c={resp:e,data:i,err_msg:t},s()},function(){r++,s("err")}),o.get({url:"/mp/videoplayer?action=get_mp_video_cover",data:{vid:e.vid||""}},function(e){r++,e&&e.base_resp&&1*e.base_resp.ret==0&&e.url?(a=e.url,s()):s("err")},function(){r++,s("err")})}}})
